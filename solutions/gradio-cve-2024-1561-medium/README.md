# gradio 4.12.0 LFI Demo - CVE-2024-1561
Report: https://huntr.com/bounties/4acf584e-2fe8-490e-878d-2d9bf2698338
Resources:
   - https://github.com/gradio-app/gradio/tree/gradio%404.12.0


## Overview
### Description
This is a vulnerability in the `gradio` package that allows an attacker to read arbitrary files on the system by sending a crafted HTTP request to the server.

The [`move_resource_to_block_cache()`](https://github.com/gradio-app/gradio/blob/227221f88755240798ca2071bd1a0d165f5a82e7/gradio/processing_utils.py#L228) is used to move a resource to the cache.

### CVE Rating

This vulnerability has been rated as a `High` severity issue because of the following factors:

  - The vulnerability allows an attacker to read arbitrary files on the system.
  - The vulnerability can be exploited remotely by sending a crafted HTTP request to the server.
  - The vulnerability can be exploited without authentication.


## Commands
### Terminal 1 - Service
```bash
docker build -t gradio-lfi-demo:4.12.0 --no-cache .
docker run -it -v ./app.py:/app/app.py -p 7860:7860 gradio-lfi-demo:4.12.0
```

### Terminal 2 - Attack
```bash
python exploit.py --server="127.0.0.1" --port="7860" --target_file="/etc/passwd"
```

**Additionally:**

```bash
python exploit.py --server="127.0.0.1" --port="7860" --target_file=/proc/self/environ
```
